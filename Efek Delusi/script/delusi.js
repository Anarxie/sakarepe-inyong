var canvas=!1,context=!1,isCanvas=document.createElement("canvas").getContext?!0:!1;createCanvas=function(b){if(isCanvas)return canvas=document.createElement("canvas"),canvas.style.position="absolute",canvas.style.width=nw+"px",canvas.style.height=nh+"px",b.appendChild(canvas),context=canvas.getContext("2d"),canvas.resize=function(b,c){canvas&&(canvas.width=b,canvas.height=c,canvas.style.width=b+"px",canvas.style.height=c+"px")},canvas;b.resize=function(b,c){return!1};return b}; createImage=isCanvas?function(b,d){img=new Image;var c=document.getElementById("gambar-delusi")?document.getElementById("gambar-delusi"):document.getElementById("efek-delusi");img.src=c.getElementsByTagName("img").item(b).src;img.sx=0;img.sy=0;img.w=0;img.h=0;img.loaded=!1;img.onload=function(){this.sx=0.5*this.width;this.sy=0.5*this.height;this.w=this.width;this.h=this.height;this.loaded=!0};img.drawImage=function(b,c,d,q,n,p,e,h){void 0==n&&(n=this.sx,p=this.sy);void 0==e&&(e=this.w,h=this.h);this.loaded&& (context.save(),context.globalAlpha=q,context.translate(b,c),context.rotate(d),context.drawImage(this,Math.round(-n),Math.round(-p),Math.round(e),Math.round(h)),context.restore())};return img}:function(b,d){var c=document.createElement("img");c.src=document.getElementById("efek-delusi").getElementsByTagName("img").item(b).src;c.style.position="absolute";c.style.left="-10000px";c.style.filter="progid:DXImageTransform.Microsoft.matrix(FilterType="+d+', sizingMethod="auto expand") alpha(opacity=100)'; c.sx=0;c.sy=0;c.w=0;c.h=0;c.loaded=!1;c.rs=!0;c.drawImage=function(b,d,m,q,n,p,e,h){if(this.complete){c.loaded||(this.sx=0.5*this.width,this.sy=0.5*this.height,this.w=this.width,this.h=this.height,c.loaded=!0);void 0==n&&(n=this.sx,p=this.sy);void 0==e&&(this.rs=!1,e=this.w,h=this.h);var f=Math.cos(m);m=Math.sin(m);var k=this.filters.item(0);k.M11=f;k.M12=-m;k.M21=m;k.M22=f;this.style.left=Math.round(b-m*(0<m?h-p:-p)-f*(0<f?n:n-e))+"px";this.style.top=Math.round(d-m*(0<m?n:n-e)-f*(0<f?p:p-h))+"px"; this.rs&&(this.style.width=Math.round(e)+"px",this.style.height=Math.round(h)+"px");this.filters.item(1).opacity=Math.round(100*q)}};canvas.appendChild(c);return c};var dolls=[],xm=0,ym=0,nx=0,ny=0,nw=0,nh=0,sphere,sw;function resize(){var b=document.getElementById("canvas");nw=b.offsetWidth;nh=b.offsetHeight;for(ny=nx=0;null!=b;b=b.offsetParent)nx+=b.offsetLeft,ny+=b.offsetTop;canvas&&(canvas.resize(nw,nh),sw=nh/4,sphere.style.width=sphere.style.height=sw+"px")}onresize=resize; document.onmousemove=function(b){window.event&&(b=window.event);xm=b.x||b.clientX;ym=b.y||b.clientY}; function Point(b){this.x=b.x+Math.random();this.y=10+Math.random();this.xb=this.x;this.yb=this.y+2;this.w=0;this.links=[];this.stiffness=b.stiffness;this.anim=function(){for(var b=0,c;c=this.links[b++];c.trigo());b=(this.x-this.xb)*this.stiffness;c=(this.y-this.yb)*this.stiffness;this.xb=this.x;this.yb=this.y;this.x+=b;this.y+=c;b=this.x-(xm-nx);c=this.y-(ym-ny);var g=Math.sqrt(b*b+c*c),l=0.5*(sw+this.w);g<l&&(g=Math.abs(l-g),a=Math.atan2(c,b),this.x+=g*Math.cos(a),this.y+=g*Math.sin(a));0>this.y? (this.y=0,this.yb=-5):this.y>nh&&(this.y=nh,this.yb=nh+5);0>this.x?(this.x=0,this.xb=-5):this.x>nw&&(this.x=nw,this.xb=nw+5)}}function createPoint(b,d,c,g){b.points[d]||(b.points[d]=new Point(b));b=b.points[d];c&&(g>b.w&&(b.w=g),b.links.push(c));return b} function Link(b,d,c,g,l,m,q){this.height=g*b.s;this.width=l*b.s;this.image=m;this.p0=createPoint(b,d,this,this.width);this.p1=createPoint(b,c);this.constraint=function(){for(var b=this.parent.angle,c=this.maxi,e=this.mini,d=this.inv;this.angle-b>Math.PI;)this.angle-=2*Math.PI;for(;this.angle-b<-Math.PI;)this.angle+=2*Math.PI;var f=this.angle-b;0<f?d?f<c&&(this.angle=b+c):c<f&&(this.angle=b+c):d?f>-e&&(this.angle=b-e):-e>f&&(this.angle=b-e);this.p1.x=this.p0.x+Math.cos(this.angle)*this.height;this.p1.y= this.p0.y+Math.sin(this.angle)*this.height;this.dx0=this.p1.x-this.p0.x;this.dy0=this.p1.y-this.p0.y};this.trigo=function(){this.dx0=this.p1.x-this.p0.x;this.dy0=this.p1.y-this.p0.y;this.angle=Math.atan2(this.dy0,this.dx0);this.parent&&this.constraint();var b=Math.sqrt(this.dx0*this.dx0+this.dy0*this.dy0),c=0.5*(this.height-b),e=this.dx0/b*c,c=this.dy0/b*c,d=0.1*(Math.random()-0.5),f=0.1*(Math.random()-0.5);this.p0.x-=e+d;this.p0.y-=c+f;this.p1.x+=e+d;this.p1.y+=c+f;this.x=this.p0.x;this.y=this.p0.y; this.d=b};this.addConstraint=function(b,c,e){0>c&&(this.inv=!0);this.mini=Math.abs(c);this.maxi=Math.abs(e);this.parent=b};this.draw=function(){this.img.drawImage(this.x,this.y,this.angle,1,0.15*this.width,0.5*this.width,this.d+0.3*this.width,this.width)};b.render[q]=this} function Doll(b,d,c,g){this.x=b;this.s=d;this.stiffness=c;this.points=[];this.render=[];for(var l in g)if(b=g[l],"constraints"==l)for(d=0;d<b.length;d++)c=b[d],g[c[0]].link.addConstraint(g[c[1]].link,c[2],c[3]);else g[l].link=new Link(this,b[0],b[1],b[2],b[3],b[4],b[5]);for(d=0;c=this.render[d++];c.img=createImage(c.image,"nearest"));this.anim=function(){for(var b=0,c;c=this.points[b++];c.anim());for(b=0;c=this.render[b++];c.draw());};this.collide=function(b){for(var c=0,d;d=this.points[c++];)for(var g= 0,e;e=b.points[g++];){var h=d.x-e.x,f=d.y-e.y,k=Math.sqrt(h*h+f*f),l=0.5*(d.w+e.w);k<l&&(k=Math.abs(l-k),f=Math.atan2(f,h),h=k*Math.cos(f)*0.5,k=k*Math.sin(f)*0.5,d.x+=h,d.y+=k,e.x-=h,e.y-=k)}}}function run(){isCanvas&&context.clearRect(0,0,nw,nh);sphere&&(sphere.style.left=xm-nx-0.5*sw+"px",sphere.style.top=ym-ny-0.5*sw+"px");dolls[0].anim();dolls[1].anim();dolls[0].collide(dolls[1]);setTimeout(run,16)} onload=function(){sphere=document.getElementById("sphere");canvas=createCanvas(document.getElementById("canvas"));resize();var b={body:[0,1,9,5,1,7],arm1:[0,6,3,3,7,0],ar11:[6,7,5,2.5,6,1],arm2:[0,8,5,3,3,8],ar21:[8,9,5,2.5,5,9],head:[0,10,4,4.5,2,6],leg1:[1,2,6,3.5,0,2],le11:[2,3,7,5,4,3],leg2:[1,4,6,3.5,0,4],le21:[4,5,7,5,4,5],constraints:[["le21","leg2",0.3,2.5],["le11","leg1",0.3,2.5],["ar11","arm1",3,0.1],["ar21","arm2",3,0.1],["head","body",-2.5,-2.5],["leg1","body",2.5,1.2],["leg2","body", 2.5,1.2]]};dolls[0]=new Doll(0.25*nw,nh/50,0.998,b);dolls[1]=new Doll(0.75*nw,nh/50,0.998,b);run()};